---
marp: true
html: true
theme: default
paginate: true
---
<style>
.dodgerblue {
  color: dodgerblue;
}
</style>
## **Similarity** search principle
<div class="mermaid">
flowchart TD

    A[<a href="/300-docker-agentic-compose-with-rag/bibendum/main.go#L37">User Question</a>] 
    C[<a href="/300-docker-agentic-compose-with-rag/bibendum/agents/stores.go#L146">Generate Question Embedding + Record</a>]
    E[<a href="/300-docker-agentic-compose-with-rag/bibendum/agents/stores.go#L153">Search Top N Similarities</a>]

    G[<a href="/300-docker-agentic-compose-with-rag/bibendum/main.go#L99">Build Context Message & System + User Messages</a>]
    K[<a href="/300-docker-agentic-compose-with-rag/bibendum/main.go#L70">Agent Stream Response</a>]

    A --> C --> E --> G --> K

    classDef query fill:#e3f2fd,stroke:#0277bd,stroke-width:2px
    classDef embedding fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef search fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef decision fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef context fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    classDef response fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px

    class A query
    class B,C,D embedding
    class E search
    class F decision
    class G,H,I,J context
    class K,L response
</div>