---
marp: true
html: true
theme: default
paginate: true
---
<style>
.dodgerblue {
  color: dodgerblue;
}
</style>
### ðŸ¤– Chat Loop Phase
<div class="mermaid">
flowchart LR
    ChatLoop{<a href="/105-bot-context-instructions/main.go#L45">Chat Loop</a>}:::loop

    ChatLoop --> CheckCommands{<a href="/105-bot-context-instructions/main.go#L50">Read Input/Cmds</a>}:::decision

    CheckCommands -->|/bye| Goodbye[<a href="/105-bot-context-instructions/main.go#L51">Say Goodbye</a>]:::exit

    Goodbye --> EndNode([End]):::final

    CheckCommands -->|/memory| ShowMemory[<a href="/105-bot-context-instructions/main.go#L56">Display Conversation History</a>]:::memory

    ShowMemory --> ChatLoop

    CheckCommands -->|Regular Message| AddToMemory[<a href="/105-bot-context-instructions/main.go#L61">Add User Message to Memory</a>]:::memory

    AddToMemory --> SendWithHistory[<a href="/105-bot-context-instructions/main.go#L63">Send Request with Full History</a> + <a href="/105-bot-context-instructions/main.go#L76">Stream Response & Accumulate</a>]:::api

    SendWithHistory --> SaveResponse[<a href="/105-bot-context-instructions/main.go#L92">Save Assistant Response to Memory</a>]:::memory

    SaveResponse --> ChatLoop

    classDef loop fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px,color:#000
    classDef prompt fill:#e8eaf6,stroke:#3f51b5,stroke-width:2px,color:#000
    classDef input fill:#fff8e1,stroke:#f9a825,stroke-width:2px,color:#000
    classDef decision fill:#fff8e1,stroke:#f9a825,stroke-width:2px,color:#000
    classDef exit fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#000
    classDef final fill:#fce4ec,stroke:#c2185b,stroke-width:3px,color:#000
    classDef memory fill:#fff3e0,stroke:#ff6f00,stroke-width:3px,color:#000
    classDef api fill:#e0f2f1,stroke:#388e3c,stroke-width:2px,color:#000
    classDef stream fill:#e1f5fe,stroke:#0277bd,stroke-width:2px,color:#000
</div>
